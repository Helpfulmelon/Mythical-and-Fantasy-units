namespace = dhe_dde_pyrrhus

dhe_dde_pyrrhus.1 = { # Molossian Ultimatum
	type = country_event
	title = "dhe_dde_pyrrhus.1.t"
	desc = {
		first_valid = {
			triggered_desc = { # Neoptolemus is available
				trigger = { 
					char:118 = { # Is Neoptolemus available?
						is_alive = yes
						is_ruler = no
						employer = root
					}
				}
				desc = "dhe_dde_pyrrhus.1.desc_1" 
			}
			triggered_desc = { # Neoptolemus is unavailable
				trigger = {
					always = yes
				}
				desc = "dhe_dde_pyrrhus.1.desc_2"
			}
		}
	}
	picture = greek_court
	left_portrait = scope:pyrrhus			
	right_portrait = scope:neoptolemus
	fire_only_once = yes
	
	trigger = { # Is Epirus, Pyrrhus is alive, Pyrrhus is ruler, Neoptolemus or Other char available
		has_dlc = "Epirus Flavor Pack"
		tag = EPI 							
		has_land = yes
		char:70 = { # Pyrrhus					
			is_alive = yes
			is_ruler = yes
			employer = root 				
		}
		OR = {	
			char:118 = { # Neoptolemus
				is_alive = yes
				is_ruler = no
				employer = root
			}
			any_character = { # Fallback Aeacid
				is_ruler = no
				trigger_if = {
					limit = {
						employer.current_ruler = {
							is_minor_character = no
						}
					}
					from_ruler_family = yes
				}
				age >= 20
				is_female = no
				prisoner = no
			}
			any_character = { # Fallback Epirote
				is_ruler = no
				age >= 20
				is_female = no
				prisoner = no
			}
		}
		
	}
	
	immediate = { # Save scopes
		char:70 = { save_scope_as = pyrrhus }
		if = { # Neoptolemus
			limit = {
				char:118 = { 
					is_alive = yes
					is_ruler = no
					employer = root
				}
			}
			char:118 = { save_scope_as = neoptolemus }
		}
		else_if = { # Fallback Aeacid
			limit = {
				any_character = {
					is_ruler = no
					trigger_if = {
						limit = {
							employer.current_ruler = {
								is_minor_character = no
							}
						}
						from_ruler_family = yes
					}
					is_female = no
					prisoner = no
					NOT = { has_character_modifier = foreign_citizen }
				}
			}
			ordered_character = {
				limit = {
					is_ruler = no
					trigger_if = {
						limit = {
							employer.current_ruler = {
								is_minor_character = no
							}
						}
						from_ruler_family = yes
					}
					age >= 20
					is_female = no
					prisoner = no
					NOT = { has_character_modifier = foreign_citizen }
				}
				order_by = prominence
				max = 1
				check_range_bounds = no
				save_scope_as = neoptolemus
			}
		}
		else = { # Fallback Epirote
			ordered_character = {
				limit = {
					employer = root
					is_ruler = no
					age >= 20
					is_female = no
					prisoner = no
					has_culture = epirote
					NOT = { has_character_modifier = foreign_citizen }
				}
				order_by = prominence
				max = 1
				check_range_bounds = no
				save_scope_as = neoptolemus
			}
		}
	}
	
	option = { # Depose Pyrrhus
		name = "dhe_dde_pyrrhus.1.a"
		set_as_ruler = scope:neoptolemus # Set new ruler
		if = {
			limit = {
				c:TLN = { current_ruler = char:105 }
			}
			reverse_add_opinion = { modifier = dhe_dde_pyrrhus_deposed_pyrrhus_op target = c:TLN } # Add -50 opinion of Epirus to Taulantia
			char:105 = { add_rival = scope:neoptolemus }
		}
		dhe_dde_pyrrhus_1_move_effect = yes # Trigger event .2 for picked country
		custom_tooltip = dhe_dde_pyrrhus.1.at
		char:70 = {
			set_variable = {
				name = pyrrhus_travelling
				days = 2000 
			}
			trigger_event = {
				id = dhe_dde_pyrrhus.9
				days = { 1800 2000 }
			}
		}
		ai_chance = { factor = 95 }
	}
	
	option = { # Support Pyrrhus
		name = "dhe_dde_pyrrhus.1.b"
		scope:pyrrhus = { add_popularity = subtract_popularity_medium } # Pyrrhus loses popularity
		add_legitimacy = subtract_legitimacy_huge # Epirus loses legitimacy
		remove_stability_effect = yes # Epirus loses stability
		add_country_modifier = { # Global unrest +4.0, Monthly legitimacy -0.30
			name = dhe_dde_pyrrhus_molossians_angered_cm
			duration = 3650 # 10 years
		}
		reverse_add_opinion = { modifier = dhe_dde_pyrrhus_angered_macedon_op target = c:MAC } # Add -75 opinion of Epirus to Macedon
		ai_chance = { factor = 5 }
	}
}

dhe_dde_pyrrhus.2 = { # Pyrrhus Seeks Supporter
	type = country_event
	title = "dhe_dde_pyrrhus.2.t" 
	desc = {
		first_valid = {
			triggered_desc = {
				trigger = { # Taulantia
					tag = TLN
				}
				desc = "dhe_dde_pyrrhus.2.desc_1"
			}
			triggered_desc = { # Fallback
				trigger = {
					has_variable = pyrrhus_fallback_flag
				}
				desc = "dhe_dde_pyrrhus.2.desc_2"
			}
			triggered_desc = { # Phrygia with Deidamia marriage
				trigger = {
					tag = PRY
					char:70 = { has_variable = flavor_epi_deidamia_demetrius_married_flag }
				}
				desc = "dhe_dde_pyrrhus.2.desc_3"
			}
			triggered_desc = { # Any Diadochus (PRY, EGY, SEL, TRE, MAC)
				trigger = {
					always = yes
				} 
				desc = "dhe_dde_pyrrhus.2.desc_4"
			}
		}
	}
	picture = greek_court
	left_portrait = current_ruler 
	right_portrait = scope:pyrrhus
	goto_location = c:EPI.capital_scope
	
	trigger = { # Triggered by 1.a scripted effect
		has_dlc = "Epirus Flavor Pack"
		has_land = yes
	}
	
	option = { # Accept Pyrrhus
		name = "dhe_dde_pyrrhus.2.a"
		custom_tooltip = dhe_dde_pyrrhus.2.yes.ct
		add_treasury = { # Remove cash
			value = has_monthly_income
			multiply = -1
		}
		save_scope_as = pyrrhus_first_country_scope # Save country scope
		if = { # Break alliance with Epirus if revelant
			limit = {
				alliance_with = c:EPI
			}
			break_alliance = c:EPI
		}
		c:EPI = { # Epirus event telling them which country helped Pyrrhus
			trigger_event = {
				id = dhe_dde_pyrrhus.22
			}
		}
		pyrrhus_refused_variable_cleaner_effect = yes # Removes refused variable from potential countries
		ai_chance = { factor = 90 } # AI should almost always accept
	}
	
	option = { # Turn Pyrrhus away
		name = "dhe_dde_pyrrhus.2.b"
		custom_tooltip = dhe_dde_pyrrhus.2.no.ct
		dhe_dde_pyrrhus_1_move_effect = yes # Pyrrhus moves to next country
		set_variable = { # Variable for move effect above
			name = pyrrhus_refused
		}
		ai_chance = { factor = 10 }
	}
}

dhe_dde_pyrrhus.3 = { # Diadochi War Hostage
	type = country_event
	title = "dhe_dde_pyrrhus.3.t"
	desc = {
		first_valid = {
			triggered_desc = { # Pyrrhus General
				trigger = {
					scope:pyrrhus = {
						OR = {
							is_general = yes
							is_admiral = yes
						}
					}
				}
				desc = "dhe_dde_pyrrhus.3.desc_3"
			}
			triggered_desc = { # Pyrrhus not General
				trigger = {
					scope:pyrrhus = {
						NOR = {
							is_general = yes
							is_admiral = yes
						}
					}
				}
				desc = "dhe_dde_pyrrhus.3.desc_4"
			}
		}
	}
	picture = pyrrhus
	left_portrait = current_ruler
	right_portrait = scope:pyrrhus
	fire_only_once = yes
	goto_location = scope:pyrrhus_second_country_scope.capital_scope
	
	trigger = { # Triggered by on_ending_war on_action
		has_dlc = "Epirus Flavor Pack"
		is_diadochus_trigger = yes # PRY, SEL, EGY, MAC or TRE
		has_land = yes
		pyrrhus_truce_trigger = yes # Has truce with another Diadochi
		c:EPI = { 
			has_land = yes 
		}
		char:70 = { # Pyrrhus alive, not king, under 22, and in first country
			is_alive = yes
			is_ruler = no
			employer = root
		}
	}
	
	immediate = {
		char:70 = { # Save Pyrrhus scope
			save_scope_as = pyrrhus
		}
		save_scope_as = pyrrhus_first_country_scope
		pyrrhus_truce_scope_effect = yes # Save truce country scope
	}
	
	option = { # Hostage - send to SECOND COUNTRY
		name = "dhe_dde_pyrrhus.3.a"
		custom_tooltip = dhe_dde_pyrrhus.3.at
		pyrrhus_hostage_effect = yes # Event .23 for c:EPI, if Pyrrhus was general add trait, send Pyrrhus to hostage country, event .20 for hostage country (information events)
		char:70 = {
			set_variable = pyrrhus_hostage_flag # flag for triggered desc in .4
		}
	}
}

dhe_dde_pyrrhus.4 = { # Supporter decides whether to back Pyrrhus
	type = country_event
	title = "dhe_dde_pyrrhus.4.t"
	desc = {
		first_valid = {
			triggered_desc = { # Pyrrhus is in Taulantia
				trigger = {
					tag = TLN
					scope:pyrrhus = {
						NOR = {
							is_general = yes
							is_admiral = yes
						}
					}
				}
				desc = "dhe_dde_pyrrhus.4.desc_1"
			}
			triggered_desc = { # Pyrrhus is in Taulantia and a general
				trigger = {
					tag = TLN
					scope:pyrrhus = { 
						OR = {
							is_general = yes
							is_admiral = yes
						}
					}
				}
				desc = "dhe_dde_pyrrhus.4.desc_2"
			}
			triggered_desc = { # Pyrrhus is a Hostage
				trigger = {
					OR = {
						AND = {
							is_diadochus_trigger = yes
							scope:pyrrhus = {
								has_variable = pyrrhus_hostage_flag
							}
						}
						has_variable = pyrrhus_fallback_flag
					}
				}
				desc = "dhe_dde_pyrrhus.4.desc_3"
			}
			triggered_desc = { # Pyrrhus is not hostage
				trigger = {
					is_diadochus_trigger = yes
					scope:pyrrhus = {
						NOR = {
							is_general = yes
							is_admiral = yes
						}
					}
				}
				desc = "dhe_dde_pyrrhus.4.desc_4"
			}
			triggered_desc = { # Pyrrhus is not hostage and a general
				trigger = {
					scope:pyrrhus = {
						OR = {
							is_general = yes
							is_admiral = yes
						}
					}
				}
				desc = "dhe_dde_pyrrhus.4.desc_5"
			}
		}
	}
	picture = pyrrhus
	left_portrait = current_ruler
	right_portrait = scope:pyrrhus
	right_portrait = scope:pyrrhus_betrothed_scope
	fire_only_once = yes
	goto_location = c:EPI.capital_scope
	
	trigger = { # EPI still exists, Pyrrhus is not king, in court, and over 18
		has_dlc = "Epirus Flavor Pack"
		has_land = yes
		c:EPI = { has_land = yes }
		char:70 = {
			is_alive = yes
			is_ruler = no
			employer = root
		}
	}
	
	immediate = {
		char:70 = { # save pyrrhus scope
			save_scope_as = pyrrhus
		}
		save_scope_as = pyrrhus_second_country_scope # save scope of current country (hostage or first)
	}
	
	option = { # Diadochus support
		name = dhe_dde_pyrrhus.4.a
		trigger = {
			is_diadochus_trigger = yes # Is PRY, EGY, SEL, TRE or MAC
			NOT = {
				has_variable = pyrrhus_fallback_flag
			}
		}
		save_scope_as = pyrrhus_supporter_scope
		scope:pyrrhus = { 
			set_variable = {
				name = pyrrhus_supported_big_flag # Pyrrhus gets elephants flag
			}
		}	
		pyrrhus_4_big_supporter_effect = yes # Add ruler friendship with Pyrrhus if possible, marry Pyrrhus to ruling family wife if possible, remove money, move Pyrrhus and wife, if general add trait, trigger .5 for EPI
		add_manpower = -4.0 # Manpower for Pyrrhus
		custom_tooltip = dhe_dde_pyrrhus.4.at
	}
	
	option = { # Not Diadochus support
		name = dhe_dde_pyrrhus.4.b
		trigger = { 
			is_diadochus_trigger = no # Not PRY, EGY, SEL, MAC or TRE
		}
		save_scope_as = pyrrhus_supporter_scope
		scope:pyrrhus = { 
			set_variable = {
				name = pyrrhus_supported_small_flag # Pyrrhus gets medium flag
			}
		}	
		pyrrhus_4_small_supporter_effect = yes # Add ruler friendship if possible, marry ruling wife if possible, remove money, move Pyrrhus and wife, if general add trait, trigger .5 for EPI
		add_manpower = -2.0 # Manpower for Pyrrhus
		custom_tooltip = dhe_dde_pyrrhus.4.bt
	}
	
	option = { # Don't Support 
		name = dhe_dde_pyrrhus.4.c
		scope:pyrrhus = {
			set_variable = {
				name = pyrrhus_not_supported_flag # Pyrrhus gets small flag
			}
		}	
		pyrrhus_4_no_supporter_effect = yes # Remove ruler friendship if exists, send to EPI, move wife is possible, if general add trait, trigger .5
		custom_tooltip = dhe_dde_pyrrhus.4.ct
	}
	
	option = { # Go home utter failure
		name = dhe_dde_pyrrhus.4.c
		trigger = {
			NOR = {
				tag = TLN
				is_diadochus_trigger = yes
				has_variable = pyrrhus_fallback_flag
			}
		}
		char:70 = {	
			set_variable = pyrrhus_fallback_return_flag
			remove_all_offices = yes
			move_country = c:EPI
			remove_character_modifier = foreign_citizen
			set_as_minor_character = this
		}
	}
}

dhe_dde_pyrrhus.5 = { # Pyrrhus Returns
	type = country_event
	title = "dhe_dde_pyrrhus.5.t"
	desc = {
		first_valid = {
			triggered_desc = { # Fallback if never supported and Pyrrhus returns as a failure
				trigger = {
					scope:pyrrhus = { has_variable = pyrrhus_fallback_return_flag }
				}
				desc = "dhe_dde_pyrrhus.5.desc_1"
			}
			triggered_desc = { # Supported by Taulantia
				trigger = {
					scope:pyrrhus = { has_variable = pyrrhus_supported_small_flag }
				}
				desc = "dhe_dde_pyrrhus.5.desc_2"
			}
			triggered_desc = { # Not Supported 
				trigger = {
					scope:pyrrhus = { has_variable = pyrrhus_not_supported_flag }
				}
				desc = "dhe_dde_pyrrhus.5.desc_3"
			}
			triggered_desc = { # Supported by Diadochus
				trigger = {
					always = yes
				}
				desc = "dhe_dde_pyrrhus.5.desc_4"
			}
		}
	}
	picture = pyrrhus
	left_portrait = current_ruler
	right_portrait = scope:pyrrhus
	fire_only_once = yes
	goto_location = scope:pyrrhus_second_country_scope.capital_scope
	
	trigger = {
		has_dlc = "Epirus Flavor Pack"
		has_land = yes
	}
	
	immediate = {
		random_army = { # Save army to add troops to
			save_scope_as = dhe_dde_pyrrhus_army_scope
		}
	}
	
	option = { # Pyrrhus takes back throne with army
		name = dhe_dde_pyrrhus.5.a
		trigger = {
			NOT = {
				scope:pyrrhus = {
					has_variable = pyrrhus_fallback_return_flag # Pyrrhus has not entirely failed
				}
			}
		}
		char:70 = {
			remove_variable = pyrrhus_travelling
		}
		if = {
			limit = { 
				current_ruler = char:118
				char:118 = { can_get_rivals = yes }
				scope:pyrrhus = { can_get_rivals = yes}
				NOT = { 
					char:118 = { is_rival = scope:pyrrhus }
				}
			}
			char:118 = { add_rival = scope:pyrrhus }
		}
		set_as_ruler = scope:pyrrhus # Pyrrhus becomes king
		pyrrhus_return_effect = yes # Add/remove opinion with supporting country, add cash and troops if relevant, move capital to ambrakia if possible, add a claim on Corfu if not owned, clear support flags
		pyrrhus_family_mover_effect = yes
		c:SYR = {
			trigger_event = {
				id = dhe_dde_pyrrhus.16
				days = { 30 90 }
			}
		}
	}
	
	option = { # Pyrrhus is crowned as a better alternative
		name = dhe_dde_pyrrhus.5.b
		trigger = {
			scope:pyrrhus = {
				has_variable = pyrrhus_fallback_return_flag # Pyrrhus has failed enitrely
			}
		}
		set_as_ruler = scope:pyrrhus
		pyrrhus_family_mover_effect = yes
		if = { # Move capital if not Ambrakia
			limit = {
				owns = 465
				NOT = {	
					p:465 = { is_capital = yes }
				}
			}
			set_capital = 465
			hidden_effect = {
				p:465.state = { set_state_capital = 465 }
			}
		}
		if = { # If EPI doesn't own Corfu add claim
			limit = {
				NOT = { owns = 470 }
			}
			p:470 = { add_claim = c:EPI }
		}
		c:SYR = {
			trigger_event = {
				id = dhe_dde_pyrrhus.16
				days = { 30 90 }
			}
		}
	}
	
	option = { # Pyrrhus returns to court as a failure
		name = dhe_dde_pyrrhus.5.c
		trigger = {
			scope:pyrrhus = {
				has_variable = pyrrhus_fallback_return_flag # Pyrrhus has failed entirely
			}
		}
		pyrrhus_family_mover_effect = yes
	}
	
	option = { # Pyrrhus is imprisoned
		name = dhe_dde_pyrrhus.5.d
		trigger = {
			scope:pyrrhus = {
				has_variable = pyrrhus_fallback_return_flag # Pyrrhus has failed entirely
			}
		}
		pyrrhus_family_mover_effect = yes
		imprison = {
			target = scope:pyrrhus
		}
		add_tyranny = tyranny_small
	}
}

dhe_dde_pyrrhus.6 = { # Conflict with Rome - Tarentum
	type = country_event
	title = "dhe_dde_pyrrhus.6.t"
	desc = "dhe_dde_pyrrhus.6.desc"
	picture = greek_siege
	left_portrait = current_ruler
	right_portrait = c:EPI.current_ruler
	fire_only_once = yes
	goto_location = c:EPI.capital_scope
	
	trigger = {
		has_dlc = "Epirus Flavor Pack" # Has DLC
		has_land = yes
		c:EPI = { has_land = yes } # Epirus exists
		char:70 = { # Pyrrhus is alive and king of EPI, and over 22
			is_alive = yes
			is_ruler = yes
			age >= 18
			employer = { tag = EPI }
		}
		war = yes
		any_countries_at_war_with = {
			OR = {
				tag = ROM
				AND = {
					capital_scope = {
						OR = {
							is_in_region = magna_graecia_region
							is_in_region = central_italy_region
							is_in_region = carthage_area
						}
					}
					any_owned_province = { is_in_region = magna_graecia_region }
					NOT = { country_culture_group = hellenic } 
				}
			}
			save_temporary_scope_as = rome_temp_scope
		}
		num_of_cities <= 5 # ROOT is small
		capital_scope = { # ROOT is in Magna Graecia
			OR = {
				is_in_area = neapolis_area
				is_in_area = cannae_area
				is_in_area = tarentum_area
				is_in_area = heraclea_area
				is_in_area = croton_area
			}
		}
		country_culture_group = hellenic # ROOT is Greek
		NOR = { # ROOT has no big ally or EPI as an ally
			any_allied_country = { num_of_cities >= 25 }
			tag = EPI
			c:EPI = {
				has_variable = pyrrhus_italian_fallback
			}
		}
		scope:rome_temp_scope = { # ROM is not allied or friendly with EPI and is big
			NOR = {
				alliance_with = c:EPI
				opinion = { 
					target = c:EPI
					value >= 100
				}
				num_of_cities <= 15 
			}
		}
	}
	
	immediate = {
		char:70 = { # Save Pyrrhus scope
			save_scope_as = pyrrhus
		}
		save_scope_as = dhe_dde_pyrrhus_tarentum_scope # Save root scope
		c:EPI = { 
			save_scope_as = dhe_dde_pyrrhus_epirus_scope # Save Epirus scope (loc)
			set_variable = {
				name = pyrrhus_italian_fallback
				days = -1
			}
		} 
		if = {
			limit = {
				war_with = c:ROM
			}
			c:ROM = {
				save_scope_as = dhe_dde_pyrrhus_rome_scope
			}
		}
		else = {
			ordered_countries_at_war_with = {
				limit = {
					capital_scope = {
						OR = {
							is_in_region = magna_graecia_region
							is_in_region = central_italy_region
						}
					}
					NOT = { country_culture_group = hellenic } 
				}
				order_by = num_of_cities
				save_scope_as = dhe_dde_pyrrhus_rome_scope
			}
		}
	}
	
	option = { # Send request to Epirus
		name = "dhe_dde_pyrrhus.6.a"
		add_political_influence = subtract_influence_medium # Diplomatic costs
		add_treasury = { # Diplomatic costs
			value = has_monthly_income
			multiply = -2
		}
		c:EPI = { # Trigger .7 for EPI
			trigger_event = { id = dhe_dde_pyrrhus.7 }
		}
		ai_chance = { factor = 80 }
		custom_tooltip = dhe_dde_pyrrhus.6.at
	}
	
	option = { # Not interested
		name = "dhe_dde_pyrrhus.6.b"
		ai_chance = { factor = 20 }
		current_ruler = { add_popularity = popularity_medium } # Strong ruler
		add_political_influence = influence_small # Talks the talk
	}
}

dhe_dde_pyrrhus.7 = { # Opportunity in Magna Graecia
	type = country_event
	title = "dhe_dde_pyrrhus.7.t"
	desc = "dhe_dde_pyrrhus.7.desc"
	picture = greek_siege
	left_portrait = current_ruler
	right_portrait = scope:dhe_dde_pyrrhus_tarentum_scope.current_ruler
	goto_location = scope:dhe_dde_pyrrhus_tarentum_scope.capital_scope

	trigger = {
		has_dlc = "Epirus Flavor Pack" # Has DLC
		has_land = yes
	}
	
	option = { # Help Tarentum country
		name = "dhe_dde_pyrrhus.7.a"
		scope:dhe_dde_pyrrhus_rome_scope = { # Trigger .8 for ROM
			trigger_event = { id = dhe_dde_pyrrhus.8 }
		}
		hidden_effect = {
			if = { # If Rome holds any provinces in Magna Graecia add EPI claims on them
				limit = {
					scope:dhe_dde_pyrrhus_rome_scope = {
						any_owned_province = { is_in_region = magna_graecia_region }
					}
				}
				area:croton_area = {
					every_area_province = {
						limit = {
							owned_or_subject_owned = scope:dhe_dde_pyrrhus_rome_scope
						}
						add_claim = c:EPI
					}
				}
				area:heraclea_area = {
					every_area_province = {
						limit = {
							owned_or_subject_owned = scope:dhe_dde_pyrrhus_rome_scope
						}
						add_claim = c:EPI
					}
				}
				area:tarentum_area = {
					every_area_province = {
						limit = {
							owned_or_subject_owned = scope:dhe_dde_pyrrhus_rome_scope
						}
						add_claim = c:EPI
					}
				}
				area:cannae_area = {
					every_area_province = {
						limit = {
							owned_or_subject_owned = scope:dhe_dde_pyrrhus_rome_scope
						}
						add_claim = c:EPI
					}
				}
				area:neapolis_area = {
					every_area_province = {
						limit = {
							owned_or_subject_owned = scope:dhe_dde_pyrrhus_rome_scope
						}
						add_claim = c:EPI
					}
				}
			}
			else = { # Else add claims on Roman provinces in Italy
				area:roma_area = {
					every_area_province = {
						limit = {
							owned_or_subject_owned = scope:dhe_dde_pyrrhus_rome_scope
						}
						add_claim = c:EPI
					}
				}
				area:south_etruria_area = {
					every_area_province = {
						limit = {
							owned_or_subject_owned = scope:dhe_dde_pyrrhus_rome_scope
						}
						add_claim = c:EPI
					}
				}
				area:aternum_area = {
					every_area_province = {
						limit = {
							owned_or_subject_owned = scope:dhe_dde_pyrrhus_rome_scope
						}
						add_claim = c:EPI
					}
				}
				area:ariminum_area = {
					every_area_province = {
						limit = {
							owned_or_subject_owned = scope:dhe_dde_pyrrhus_rome_scope
						}
						add_claim = c:EPI
					}
				}
				area:asculum_area = {
					every_area_province = {
						limit = {
							owned_or_subject_owned = scope:dhe_dde_pyrrhus_rome_scope
						}
						add_claim = c:EPI
					}
				}
				area:north_etruria_area = {
					every_area_province = {
						limit = {
							owned_or_subject_owned = scope:dhe_dde_pyrrhus_rome_scope
						}
						add_claim = c:EPI
					}
				}
			}
		}
		hidden_effect = {
			every_country = { # Notification for nearby countries
				limit = {
					capital_scope = {
						OR = {
							is_in_area = neapolis_area
							is_in_area = cannae_area
							is_in_area = tarentum_area
							is_in_area = heraclea_area
							is_in_area = croton_area
						}
					}
					NOT = { alliance_with = scope:dhe_dde_pyrrhus_rome_scope }
				}
				trigger_event = { id = dhe_dde_pyrrhus.8 } # Trigger .8
				add_opinion = { modifier = dhe_dde_pyrrhus_intervention_op target = c:EPI } # +50 opinion of Epirus for standing up to Rome
			}
		}
		custom_tooltip = dhe_dde_pyrrhus.7.at
	}
}

dhe_dde_pyrrhus.8 = { # Pyrrhus' Italian Ambitions - Rome/Tarentum Ping
	type = country_event
	title = "dhe_dde_pyrrhus.8.t"
	desc = {
		first_valid = {
			triggered_desc = { # ROM desc
				trigger = {
					tag = ROM
				}
				desc = "dhe_dde_pyrrhus.8.desc_1"
			}
			triggered_desc = { # Tarentum country desc
				trigger = {
					this = scope:dhe_dde_pyrrhus_tarentum_scope
				}
				desc = "dhe_dde_pyrrhus.8.desc_2"
			}
			triggered_desc = { # Other desc
				trigger = {
					always = yes
				}
				desc = "dhe_dde_pyrrhus.8.desc_3"
			}
		}
	}
	picture = epirote_phalanx
	left_portrait = current_ruler
	right_portrait = scope:pyrrhus
	fire_only_once = yes
	goto_location = c:EPI.capital_scope
	
	trigger = {
		has_dlc = "Epirus Flavor Pack" # Has dlc
		has_land = yes
	}
	
	option = { # Rome option - darn
		name = "dhe_dde_pyrrhus.8.a"
		trigger = { # ROM option
			tag = ROM
		}
		custom_tooltip = dhe_dde_pyrrhus.8.at
	}
	
	option = { # Others option - hooray
		name = "dhe_dde_pyrrhus.8.b"
		trigger = { # NOT ROM option
			NOT = { tag = ROM }
		}
		custom_tooltip = dhe_dde_pyrrhus.8.bt
	}
}

dhe_dde_pyrrhus.9 = { # Trigger .4 for Pyrrhus employer
	type = character_event
	fire_only_once = yes
	hidden = yes
	
	trigger = { # Triggered by Pyrrhus turning 16 in a country other than Epirus
		has_dlc = "Epirus Flavor Pack"
		is_alive = yes
		NOT = {
			employer = c:EPI
		}
	}
	
	immediate = {
		employer = {
			trigger_event = {
				id = dhe_dde_pyrrhus.4
			}
		}
	}
}

dhe_dde_pyrrhus.10 = { # Pyrrhus is dead before he returns to EPI
	type = country_event
	title = "dhe_dde_pyrrhus.10.t"
	desc = "dhe_dde_pyrrhus.10.desc"
	picture = pyrrhus
	left_portrait = current_ruler
	fire_only_once = yes
	
	trigger = { # Triggered by on_death on_action, only triggers for EPI
		has_dlc = "Epirus Flavor Pack"
		has_land = yes
	}

	option = { # Goodnight sweet prince
		name = "dhe_dde_pyrrhus.10.a"
	}
}

dhe_dde_pyrrhus.11 = { # Pyrrhus and Lysimachus - Epirus
	type = country_event
	title = "dhe_dde_pyrrhus.11.t"
	desc = dhe_dde_pyrrhus.11.desc
	picture = successors
	left_portrait = current_ruler
	right_portrait = c:TRE.current_ruler
	fire_only_once = yes
	goto_location = c:TRE.capital_scope
	
	trigger = {
		has_dlc = "Epirus Flavor Pack" # Has DLC?
		current_date > 452.1.1
		c:EPI = { # Epirus exists?
			has_land = yes
		}
		tag = EPI # Is Epi?
		char:70 = { # Pyrrhus alive, 22, and king of Epirus?
			is_alive = yes
			is_ruler = yes 
			employer = { tag = EPI }
			age >= 18
		}
		c:MAC = { has_land = yes } # Macedon exists?
		c:TRE = { # Thrace exists and is not already friends with Epirus?
			has_land = yes
			NOR = {
				alliance_with = c:EPI
				opinion = {
					target = c:EPI
					value <= -10
				}
			}
		}
		c:MAC = { # Macedon neighbors Epirus and Thrace and is not friendly with Epirus?
			AND = {
				any_neighbour_country = {
					tag = EPI
				}
				any_neighbour_country = {
					tag = TRE
				}
			}
			NOR = {
				alliance_with = c:EPI
				opinion = { 
					target = c:EPI
					value >= 100
				}
			}
		}
	}
	
	immediate = {
		char:70 = {
			save_scope_as = pyrrhus # Save Pyrrhus scope
		}
		c:TRE = {
			current_ruler = { save_scope_as = dhe_dde_pyrrhus_thrace_scope } # Save Lysimachus scope
		}
	}

	option = { # Send envoy
		name = "dhe_dde_pyrrhus.11.a"
		add_treasury = { # Cost of envoy
			value = has_monthly_income
			multiply = -2
		}
		add_political_influence = subtract_influence_small # Cost of envoy
		custom_tooltip = dhe_dde_pyrrhus.11.at
		c:TRE = { # Trigger .12 for Thrace
			trigger_event = { id = dhe_dde_pyrrhus.12 }
		}
		ai_chance = { factor = 95 }
	}
	
	option = { # Not interested
		name = "dhe_dde_pyrrhus.11.b"
		ai_chance = { factor = 5 }
	}
}

dhe_dde_pyrrhus.12 = { # Pyrrhus and Lysimachus - Thrace
	type = country_event
	title = "dhe_dde_pyrrhus.12.t"
	desc = "dhe_dde_pyrrhus.12.desc"
	picture = pyrrhus
	left_portrait = current_ruler
	right_portrait = c:EPI.current_ruler
	fire_only_once = yes
	goto_location = c:EPI.capital_scope
	
	trigger = {
		has_dlc = "Epirus Flavor Pack" # Has DLC?
		has_land = yes
	}

	option = { # Friendship
		name = "dhe_dde_pyrrhus.12.a"
		reverse_add_opinion = { modifier = dhe_dde_pyrrhus_lysimachus_op target = c:EPI } # Add 100 opinion of Epirus to Thrace
		add_opinion = { modifier = dhe_dde_pyrrhus_lysimachus_op target = c:EPI } # Add 100 opinion of Thrace to Epirus
		c:EPI = { # Trigger acceptance event .25 for EPI
			trigger_event = { id = dhe_dde_pyrrhus.25 }
		}
		custom_tooltip = dhe_dde_pyrrhus.12.at
		ai_chance = { factor = 95 }
	}
	
	option = { # Not interested
		name = "dhe_dde_pyrrhus.12.b"
		c:EPI = { # Trigger rejection event .26 for EPI
			trigger_event = { id = dhe_dde_pyrrhus.26 }
		}
		ai_chance = { factor = 5 }
	}
}

dhe_dde_pyrrhus.13 = { # Dodona Construction 
	type = country_event
	hidden = yes

	trigger = { # Triggered by decision, hidden event triggers .14
		has_dlc = "Epirus Flavor Pack"
		has_land = yes
	}

	immediate = {
		save_scope_as = dodona_builder
	}
	
	option = {
		name = "dhe_dde_pyrrhus.13.a"
		custom_tooltip = dhe_dde_pyrrhus.13.at
		set_variable = { 
			name = dhe_dde_pyrrhus_dodona_started_flag
		}
	}
}

dhe_dde_pyrrhus.14 = { # Dodona Completed
	type = country_event
	title = "dhe_dde_pyrrhus.14.t"
	desc = "dhe_dde_pyrrhus.14.desc"
	picture = dodona
	left_portrait = current_ruler
	fire_only_once = yes
	goto_location = p:425

	trigger = {
		has_dlc = "Epirus Flavor Pack" # Has DLC?
		tag = EPI # Still Epirus?
		has_land = yes
		owns = 425 # Owns Dodona?
	}

	immediate = {
		set_variable = {
			name = dodona_boon_toggle
			days = 1825 # Toggle for .15
		}
	}
	
	option = {
		name = "dhe_dde_pyrrhus.14.a"
		add_stability_effect = yes # Add religious power
		add_country_modifier = { # Omen Duration +0.10%, Omen power cost -0.10%
			name = dhe_dde_pyrrhus_blessings_of_dodona_cm
			duration = 7300 # 20 years
		}	
		p:425 = { # +5 civilization value, +0.10 commerce income
			add_permanent_province_modifier = { 
				name = dhe_dde_pyrrhus_dodona_pm
				duration = -1
			}
			show_model = "wonder_dodona_oracle"
		}
		if = { # Remove construction flag
			limit = {
				has_variable = dhe_dde_pyrrhus_dodona_started_flag
			}
			remove_variable = dhe_dde_pyrrhus_dodona_started_flag
		}
	}
}

dhe_dde_pyrrhus.15 = { # Dodona Boons
	type = country_event
	title = "dhe_dde_pyrrhus.15.t"
	desc = "dhe_dde_pyrrhus.15.desc"
	picture = greek_theater
	left_portrait = current_ruler
	goto_location = p:425
	fire_only_once = yes
	
	trigger = {
		NOT = { has_variable = dodona_boon_toggle }
		has_dlc = "Epirus Flavor Pack" # Has DLC
		tag = EPI # Is Epirus?
		has_land = yes
		owns = 425 # Owns Dodona?
		p:425 = { has_province_modifier = dhe_dde_pyrrhus_dodona_pm } # Dodona completed?
	}	

	option = { # Reap the rewards
		name = "dhe_dde_pyrrhus.15.a"
		add_treasury = {
			value = has_monthly_income
			multiply = 3
		}
		add_stability = 5
	}

	option = { # The gods deserve more
		name = "dhe_dde_pyrrhus.15.b"
		add_political_influence = subtract_influence_small # Costs
		add_treasury = { # Costs
			value = has_monthly_income
			multiply = -3
		}
		add_country_modifier = { # 0.10 land morale modifier, 0.10 religious tech boost
			name = dhe_dde_pyrrhus_dodona_boon_cm
			duration = 3650 # 10 years
		}
	}
}

dhe_dde_pyrrhus.16 = { # Syracuse Marriage I - Syracuse
	type = country_event
	title = "dhe_dde_pyrrhus.16.t"
	desc = "dhe_dde_pyrrhus.16.desc"
	picture = pyrrhus
	left_portrait = current_ruler
	left_portrait = scope:pyrrhus_betrothed_scope
	right_portrait = c:EPI.current_ruler
	fire_only_once = yes
	goto_location = c:EPI.capital_scope
	
	trigger = {
		has_dlc = "Epirus Flavor Pack"
		has_land = yes
		tag = SYR
		c:EPI = { has_land = yes }
		char:70 = {
			is_alive = yes 
			is_ruler = yes
			age >= 18
			employer = { tag = EPI }
		}
		c:SYR = { # Syracuse is small and has a suitable bride
			num_of_cities <= 15
			is_monarchy = yes
			pyrrhus_wife_finder_trigger = yes
		} 
		war = no
	}
	
	immediate = {
		char:70 = {
			save_scope_as = pyrrhus
		}
		current_ruler = { save_scope_as = agathocles }
		if = { # If Lanassa alive and unmarried in Syracuse
			limit = {
				char:56 = {
					trigger_if = {
						limit = {
							employer.current_ruler = {
								is_minor_character = no
							}
						}
						from_ruler_family = yes
					}
					is_married = no
					employer = root
				}
			}
			char:56 = { save_scope_as = pyrrhus_betrothed_scope } # Lanassa
		}
		else = { # Find random female of ruling dynasty
			pyrrhus_wife_finder_effect = yes
		}
	}
	
	option = { #  Send request to EPI
		name = "dhe_dde_pyrrhus.16.a"
		c:EPI = { 
			trigger_event = { id = dhe_dde_pyrrhus.17 }
		}
		if = {
			limit = {
				owns = 470
			}
			custom_tooltip = dhe_dde_pyrrhus.16.at_1 # Corfu tooltip
		}
		else = {
			custom_tooltip = dhe_dde_pyrrhus.16.at_2 # Money tooltip
		}
		ai_chance = { factor = 70 }
	}
	
	option = { # Not interested
		name = "dhe_dde_pyrrhus.16.b"
		ai_chance = { factor = 30 }
	}
}

dhe_dde_pyrrhus.17 = { # Syracuse Marriage II - Epirus
	type = country_event
	title = "dhe_dde_pyrrhus.17.t"
	desc = "dhe_dde_pyrrhus.17.desc"
	picture = greek_court
	left_portrait = current_ruler
	right_portrait = c:SYR.current_ruler
	right_portrait = scope:pyrrhus_betrothed_scope
	fire_only_once = yes
	goto_location = c:SYR.capital_scope
	
	trigger = {
		has_dlc = "Epirus Flavor Pack"
		has_land = yes
	}
	
	option = { # Accept proposal
		name = "dhe_dde_pyrrhus.17.a"
		scope:pyrrhus_betrothed_scope = {
			if = {
				limit = { is_married = yes}
				hidden_effect = { divorce_character = scope:pyrrhus_betrothed_scope.spouse }
			}
		}
		scope:pyrrhus = { # Marry Syracusan bride
			if = {
				limit = { is_married = yes}
				hidden_effect = { divorce_character = scope:pyrrhus.spouse }
			}
			marry_character = scope:pyrrhus_betrothed_scope
			set_variable = {
				name = dhe_dde_pyrrhus_marriage_syracuse_flag
			}
		}
		reverse_add_opinion = { modifier = dhe_dde_pyrrhus_syracuse_op target = c:SYR } # Add 100 opinion of Epirus to Syracuse
		add_opinion = { modifier = dhe_dde_pyrrhus_syracuse_op target = c:SYR } # Add 100 opinion of Syracuse to Epirus
		if = { # If Syracuse owns Corfu take as dowry
			limit = {
				c:SYR = { owns = 470 }
			}
			hidden_effect = {
				p:470 = { set_owned_by = c:EPI }
			}
			custom_tooltip = dhe_dde_pyrrhus.17.at_1
		}
		else = { # Else receive money as dowry
			hidden_effect = {
				c:SYR = {
					add_treasury = { value = -200 }
				}
				c:EPI = {
					add_treasury = { value = 200 }
				}
			}
			custom_tooltip = dhe_dde_pyrrhus.17.at_2
		}
		c:SYR = {
			trigger_event = {
				id = dhe_dde_pyrrhus.28
			}
		}
	}
	option = { # Won't abandon current wife
		name = "dhe_dde_pyrrhus.17.b"
		trigger = {
			scope:pyrrhus = { is_married = yes }
		}
		c:SYR = {
			trigger_event = {
				id = dhe_dde_pyrrhus.29
			}
		}
	}
	
	option = { # Not interested
		name = "dhe_dde_pyrrhus.17.c"
		trigger = {
			scope:pyrrhus = { is_married = no }
		}
		c:SYR = {
			trigger_event = {
				id = dhe_dde_pyrrhus.29 
			}
		}
	}
}

dhe_dde_pyrrhus.18 = { # Claims in Sicily Syracuse
	type = country_event
	title = "dhe_dde_pyrrhus.18.t"
	desc = {
		first_valid = {
			triggered_desc = { # No Syracusan/Epirote marriage
				trigger = {
					NOT = {
						scope:pyrrhus = { has_variable = dhe_dde_pyrrhus_marriage_syracuse_flag }
					}
				}
				desc = "dhe_dde_pyrrhus.18.desc_1"
			}
			triggered_desc = { # Syracusan/Epirote marriage
				trigger = {
					always = yes
				}
				desc = "dhe_dde_pyrrhus.18.desc_2"
			}
		}
	}
	picture = epirote_phalanx
	left_portrait = current_ruler
	right_portrait = c:EPI.current_ruler
	fire_only_once = yes
	goto_location = c:EPI.capital_scope
	
	trigger = {
		has_dlc = "Epirus Flavor Pack"
		current_date > 452.1.1
		has_land = yes
		tag = SYR # Is Syracuse
		c:SYR = { # Syracuse is small lad
			num_of_cities <= 20
		}
		c:CAR = { has_land = yes } # Carthage exists
		c:CAR = { # Carthage owns lands in Sicily and is big lad
			num_of_cities >= 70
			any_owned_province = {
				OR = {
					is_in_area = east_sicily_area
					is_in_area = west_sicily_area
				}
			}
		}
		war_with = c:CAR # At war with Carthage
		char:70 = { # Pyrrhus alive, ruler of EPI and > 18
			is_alive = yes
			is_ruler = yes
			employer = { tag = EPI }
			age >= 18
		}
		char:56 = { is_alive = no } # Agathocles dead
		NOR = { 
			any_allied_country = { # Syracuse has no large allies
				num_of_cities >= 25
			}
			opinion = { target = c:EPI value >= -10 } # Don't hate Epirus
		} 
		OR = {
			scope:pyrrhus = { has_variable = dhe_dde_pyrrhus_marriage_syracuse_flag } # Syracusan-Epirote Marriage
			c:EPI = { # Epirus owns land in Italy
				any_owned_province = {
					OR = {
						is_in_region = magna_graecia_region
						is_in_region = central_italy_region 
					}
				}
			}
		}
	}
	
	immediate = {
		char:70 = {
			save_scope_as = pyrrhus
		}
	}

	option = {
		name = "dhe_dde_pyrrhus.18.a"
		c:EPI = { trigger_event = dhe_dde_pyrrhus.19 } # Epirus receive proposal
		custom_tooltip = dhe_dde_pyrrhus.18.at
		ai_chance = { factor = 60 }
	}

	option = {
		name = "dhe_dde_pyrrhus.18.b"
		ai_chance = { factor = 40 }
		c:EPI = {
			trigger_event = { id = dhe_dde_pyrrhus.21 }
		}
		custom_tooltip = dhe_dde_pyrrhus.18.bt
	}
}

dhe_dde_pyrrhus.19 = { # Claims in Sicily II Epirus
	type = country_event
	title = "dhe_dde_pyrrhus.19.t"
	desc = {
		first_valid = {
			triggered_desc = { # No Syracusan/Epirote marriage
				trigger = {
					NOT = {
						scope:pyrrhus = { has_variable = dhe_dde_pyrrhus_marriage_syracuse_flag }
					}
				}
				desc = "dhe_dde_pyrrhus.19.desc_1"
			}
			triggered_desc = { # Syracusan/Epirote marriage
				trigger = {
					always = yes
				}
				desc = "dhe_dde_pyrrhus.19.desc_2"
			}
		}
	}
	picture = epirote_phalanx
	left_portrait = current_ruler
	right_portrait = c:SYR.current_ruler
	fire_only_once = yes
	goto_location = c:SYR.capital_scope
	
	trigger = {
		has_dlc = "Epirus Flavor Pack"
		has_land = yes
	}

	option = { # Accept war request
		name = "dhe_dde_pyrrhus.19.a"
		hidden_effect = {
			if = { # Set wargoal in West Sicily if possible
				limit = {
					area:west_sicily_area = {
						any_area_province = { owned_or_subject_owned = c:CAR }
					}
				}
				area:west_sicily_area = {
					random_area_province = {
						limit = {
							owned_or_subject_owned = c:CAR
						}
						save_scope_as = dhe_dde_carthage_sicily_wargoal_province_scope
					}   
				}
			}
			else = { # Set wargoal in East Sicily otherwise
				area:east_sicily_area = {
					random_area_province = {
						limit = {
							owned_or_subject_owned = c:CAR
						}
						save_scope_as = dhe_dde_carthage_sicily_wargoal_province_scope
					}   
				}
			}
			make_subject = {
				target = c:SYR
				type = client_state
			}
			declare_war_with_wargoal = { # Declare war on Carthage
				war_goal = conquer_wargoal
				province = scope:dhe_dde_carthage_sicily_wargoal_province_scope
				target = CAR
			}
			area:east_sicily_area = { # Add claims on all of Sicily
				every_area_province = { add_claim = c:EPI }
			}
			area:west_sicily_area = {
				every_area_province = { add_claim = c:EPI }
			}
		}
		add_country_modifier = { # Morale and manpower
			name = dhe_dde_pyrrhus_readiness_for_war_cm 
			duration = 3650 # 10 years
		}
		if = { # Remove marriage flag
			limit = {
				scope:pyrrhus = { has_variable = dhe_dde_pyrrhus_marriage_syracuse_flag }
			}
			scope:pyrrhus = { remove_variable = dhe_dde_pyrrhus_marriage_syracuse_flag }
		} 
		custom_tooltip = dhe_dde_pyrrhus.19.at
		c:SYR = {
			trigger_event = {
				id = dhe_dde_pyrrhus.30
			}
		}
		c:CAR = {
			trigger_event = {
				id = dhe_dde_pyrrhus.30
			}
		}
		every_country = { # Notification for nearby countries
			limit = {
				capital_scope = {
					OR = {
						is_in_area = east_sicily_area
						is_in_area = west_sicily_area
						is_in_area = tarentum_area
						is_in_area = heraclea_area
						is_in_area = croton_area
					}
				}
				country_culture_group = hellenic
				NOT = { alliance_with = c:CAR }
			}
			trigger_event = { id = dhe_dde_pyrrhus.30 }
			hidden_effect = {
				add_opinion = { modifier = dhe_dde_pyrrhus_intervention_op target = c:EPI } # +50 opinion of Epirus for standing up to Carthage
			}
		}
	}
	
	option = { # Decline war request
		name = "dhe_dde_pyrrhus.19.b"
		if = { # Remove marriage flag
			limit = {
				scope:pyrrhus = { has_variable = dhe_dde_pyrrhus_marriage_syracuse_flag }
			}
			scope:pyrrhus = { remove_variable = dhe_dde_pyrrhus_marriage_syracuse_flag }
		}
		reverse_add_opinion = { modifier = dhe_dde_pyrrhus_refused_syracuse_op target = c:SYR } # Add -50 opinion of Epirus to Syracuse
		custom_tooltip = dhe_dde_pyrrhus.19.bt
		c:SYR = {
			trigger_event = {
				id = dhe_dde_pyrrhus.31
			}
		}
		hidden_effect = {
			area:east_sicily_area = { # Add claims on all of Sicily
				every_area_province = { add_claim = c:EPI }
			}	
			area:west_sicily_area = {
				every_area_province = { add_claim = c:EPI }
			}
		}
	}
}

dhe_dde_pyrrhus.20 = { # Hostage Received
	type = country_event
	title = "dhe_dde_pyrrhus.20.t"
	desc = "dhe_dde_pyrrhus.20.desc"
	picture = pyrrhus
	left_portrait = current_ruler
	right_portrait = scope:pyrrhus
	fire_only_once = yes
	goto_location = c:pyrrhus_first_country_scope.capital_scope
	
	trigger = {
		has_dlc = "Epirus Flavor Pack"
		has_land = yes
	}

	immediate = {
		char:70 = {
			employer = {
				save_scope_as = pyrrhus_first_country_scope
			}
		}
	}

	option = {
		name = "dhe_dde_pyrrhus.20.a"
		custom_tooltip = dhe_dde_pyrrhus.20.at 
	}
}

dhe_dde_pyrrhus.21 = { # Claims in Sicily announced if not asked for help by Syracuse
	type = country_event
	title = "dhe_dde_pyrrhus.21.t"
	desc = {
		first_valid = {
			triggered_desc = { # No marriage
				trigger = {
					NOT = {
						scope:pyrrhus = { has_variable = dhe_dde_pyrrhus_marriage_syracuse_flag }
					}
				}
				desc = "dhe_dde_pyrrhus.21.desc_1"
			}
			triggered_desc = { # Marriage
				trigger = {
					always = yes
				}
				desc = "dhe_dde_pyrrhus.21.desc_2"
			}
		}
	}
	picture = epirote_phalanx
	left_portrait = current_ruler
	fire_only_once = yes
	goto_location = c:SYR.capital_scope
	
	trigger = {
		has_dlc = "Epirus Flavor Pack"
		has_land = yes
	}

	option = {
		name = "dhe_dde_pyrrhus.21.a"
		hidden_effect = {
			area:east_sicily_area = {
				every_area_province = { add_claim = c:EPI }
			}
			area:west_sicily_area = {
				every_area_province = { add_claim = c:EPI }
			}
		}
		custom_tooltip = dhe_dde_pyrrhus.21.at
		if = {
			limit = {
				scope:pyrrhus = { has_variable = dhe_dde_pyrrhus_marriage_syracuse_flag }
			}
			scope:pyrrhus = { remove_variable = dhe_dde_pyrrhus_marriage_syracuse_flag }
		}
	}
}

dhe_dde_pyrrhus.22 = { # Receiving country popup for Epirus
	type = country_event
	title = "dhe_dde_pyrrhus.22.t"
	desc = {
		first_valid = {
			triggered_desc = { # TLN
				trigger = {
					scope:pyrrhus_first_country_scope = { tag = TLN }
				}
				desc = "dhe_dde_pyrrhus.22.desc_1"
			}
			triggered_desc = { # Diadochus
				trigger = {
					scope:pyrrhus_first_country_scope = { tag = PRY }
					char:70 = { has_variable = flavor_epi_deidamia_demetrius_married_flag }
				}
				desc = "dhe_dde_pyrrhus.22.desc_2"
			}
			triggered_desc = { # Diadochus
				trigger = {
					scope:pyrrhus_first_country_scope = { is_diadochus_trigger = yes }
				}
				desc = "dhe_dde_pyrrhus.22.desc_3"
			}
			triggered_desc = { # Other
				trigger = {
					always = yes
				}
				desc = "dhe_dde_pyrrhus.22.desc_4"
			}
		}
	}
	picture = greek_court
	left_portrait = current_ruler
	right_portrait = scope:pyrrhus_first_country_ruler_scope
	right_portrait = scope:pyrrhus
	fire_only_once = yes
	goto_location = scope:pyrrhus_first_country_ruler_scope.capital_scope
	
	trigger = {
		has_dlc = "Epirus Flavor Pack"
		has_land = yes
	}
	
	immediate = {
		scope:pyrrhus_first_country_scope = {
			current_ruler = {
				save_scope_as = pyrrhus_first_country_ruler_scope
			}
		}
	}
	
	option = {
		name = "dhe_dde_pyrrhus.22.a"
		add_opinion = { modifier = dhe_dde_pyrrhus_supports_pyrrhus_op target = scope:pyrrhus_first_country_scope } #Add -50 opinion of ROOT to Epirus
	}
}

dhe_dde_pyrrhus.23 = { # Hostage country popup for Epirus
	type = country_event
	title = "dhe_dde_pyrrhus.23.t"
	desc = "dhe_dde_pyrrhus.23.desc"
	picture = pyrrhus
	goto_location = scope:pyrrhus_second_country_ruler_scope.capital_scope
	left_portrait = current_ruler
	right_portrait = scope:pyrrhus_first_country_ruler_scope
	right_portrait = scope:pyrrhus_second_country_ruler_scope
	right_portrait = scope:pyrrhus
	fire_only_once = yes

	trigger = {
		has_dlc = "Epirus Flavor Pack"
		has_land = yes
	}
	
	immediate = {
		scope:pyrrhus_first_country_scope = {
			current_ruler = {
				save_scope_as = pyrrhus_first_country_ruler_scope
			}
		}
		scope:pyrrhus_second_country_scope = {
			current_ruler = {
				save_scope_as = pyrrhus_second_country_ruler_scope
			}
		}
	}
	
	option = {
		name = "dhe_dde_pyrrhus.23.a"
	}
}

dhe_dde_pyrrhus.24 = { # Startup trigger
	type = country_event
	hidden = yes
	fire_only_once = yes

	trigger = {
		has_dlc = "Epirus Flavor Pack"
		tag = EPI
	}

	immediate = { # Triggers .1 within 3 years
		c:EPI = {
			trigger_event = {
				id = dhe_dde_pyrrhus.1
				days = { 365 730 }
			}
		}
		c:EPI = {
			trigger_event = {
				id = dhe_dde_pyrrhus.32
				days = 3650 # 10 years
			}
		}
	}
}

dhe_dde_pyrrhus.25 = { # Pyrrhus and Lysimachus - Response for Thrace acceptance
	type = country_event
	title = "dhe_dde_pyrrhus.25.t"
	desc = "dhe_dde_pyrrhus.25.desc"
	picture = successors
	left_portrait = current_ruler
	right_portrait = c:TRE.current_ruler
	fire_only_once = yes
	goto_location = c:TRE.capital_scope
	
	trigger = {
		has_dlc = "Epirus Flavor Pack"
		has_land = yes
	}
	
	option = { # Friendship
		name = "dhe_dde_pyrrhus.25.a"
		reverse_add_opinion = { modifier = dhe_dde_pyrrhus_lysimachus_op target = c:TRE } # Add 75 opinion of Epirus to Thrace
		add_opinion = { modifier = dhe_dde_pyrrhus_lysimachus_op target = c:TRE } # Add 75 opinion of Thrace to Epirus
	}
}

dhe_dde_pyrrhus.26 = { # Pyrrhus and Lysimachus - Response for Thrace rejection
	type = country_event
	title = "dhe_dde_pyrrhus.26.t"
	desc = "dhe_dde_pyrrhus.26.desc"
	picture = successors
	left_portrait = current_ruler
	right_portrait = c:TRE.current_ruler
	fire_only_once = yes
	goto_location = c:TRE.capital_scope
	
	trigger = {
		has_dlc = "Epirus Flavor Pack"
		has_land = yes
	}
	
	option = { # Not interested
		name = "dhe_dde_pyrrhus.26.a"
	}
}

dhe_dde_pyrrhus.27 = { # Pyrrhus Comes of Age in Foreign Court
	type = country_event
	title = "dhe_dde_pyrrhus.27.t"
	desc = "dhe_dde_pyrrhus.27.desc"
	picture = pyrrhus
	left_portrait = current_ruler
	right_portrait = char:70
	fire_only_once = yes
	
	trigger = { # Triggered by Pyrrhus turning 16 in a country other than Epirus
		has_dlc = "Epirus Flavor Pack"
	}
	
	option = {
		name = "dhe_dde_pyrrhus.27.a"
	}
}

dhe_dde_pyrrhus.28 = { # Pyrrhus Accepts Offer
	type = country_event
	title = "dhe_dde_pyrrhus.28.t"
	desc = "dhe_dde_pyrrhus.28.desc"
	picture = pyrrhus
	left_portrait = current_ruler
	right_portrait = char:70
	fire_only_once = yes
	goto_location = c:EPI.capital_scope
	
	trigger = {
		has_dlc = "Epirus Flavor Pack"
		has_land = yes
	}
	
	option = {
		name = "dhe_dde_pyrrhus.28.a"
	}
}

dhe_dde_pyrrhus.29 = { # Pyrrhus Didn't Want A Wife
	type = country_event
	title = "dhe_dde_pyrrhus.29.t"
	desc = {
		first_valid = {
			triggered_desc = { # TLN
				trigger = {
					char:70 = {
						is_married = yes
					}
				}
				desc = "dhe_dde_pyrrhus.29.desc_1"
			}
			triggered_desc = { # Other
				trigger = {
					always = yes
				}
				desc = "dhe_dde_pyrrhus.29.desc_2"
			}
		}
	}
	picture = pyrrhus
	left_portrait = current_ruler
	right_portrait = char:70
	fire_only_once = yes
	goto_location = c:EPI.capital_scope
	
	trigger = {
		has_dlc = "Epirus Flavor Pack"
		has_land = yes
	}
	
	option = {
		name = "dhe_dde_pyrrhus.29.a"
	}
}

dhe_dde_pyrrhus.30 = { # Pyrrhus Aids Us
	type = country_event
	title = "dhe_dde_pyrrhus.30.t"
	desc = {
		first_valid = {
			triggered_desc = { # Syracuse
				trigger = {
					tag = SYR
				}
				desc = "dhe_dde_pyrrhus.30.desc_1"
			}
			triggered_desc = { # Carthage
				trigger = {
					tag = CAR
				}
				desc = "dhe_dde_pyrrhus.30.desc_2"
			}
			triggered_desc = { # Other
				trigger = {
					always = yes
				}
				desc = "dhe_dde_pyrrhus.30.desc_3"
			}
		}
	}
	picture = epirote_phalanx
	left_portrait = current_ruler
	right_portrait = char:70
	fire_only_once = yes
	goto_location = c:EPI.capital_scope
	
	trigger = {
		has_dlc = "Epirus Flavor Pack"
		has_land = yes
	}
	
	option = {
		name = "dhe_dde_pyrrhus.30.a"
		trigger = {
			tag = SYR
		}
		custom_tooltip = dhe_dde_pyrrhus.30.tooltip
	}
	
	option = {
		name = "dhe_dde_pyrrhus.30.b"
		trigger = {
			tag = CAR
		}
		custom_tooltip = dhe_dde_pyrrhus.30.tooltip
	}
	
	option = {
		name = "dhe_dde_pyrrhus.30.c"
		trigger = {
			NOR = { 
				tag = SYR
				tag = CAR
			}
		}
		custom_tooltip = dhe_dde_pyrrhus.30.tooltip
	}
}

dhe_dde_pyrrhus.31 = { # Pyrrhus Refuses Aid
	type = country_event
	title = "dhe_dde_pyrrhus.31.t"
	desc = "dhe_dde_pyrrhus.31.desc"
	picture = pyrrhus
	left_portrait = current_ruler
	right_portrait = char:70
	fire_only_once = yes
	goto_location = c:EPI.capital_scope
	
	trigger = {
		has_dlc = "Epirus Flavor Pack"
		has_land = yes
	}
	
	option = {
		name = "dhe_dde_pyrrhus.31.a"
		custom_tooltip = dhe_dde_pyrrhus.31.at
	}
}

dhe_dde_pyrrhus.32 = { # Fallback Claims in Italy
	type = country_event
	title = "dhe_dde_pyrrhus.32.t"
	desc = "dhe_dde_pyrrhus.32.desc"
	picture = pyrrhus
	left_portrait = current_ruler
	fire_only_once = yes
	
	trigger = {
		has_dlc = "Epirus Flavor Pack"
		has_land = yes
		tag = EPI
		current_ruler = {
			this = char:70
		}
		NOT = { has_variable = pyrrhus_italian_fallback }
	}
	
	option = {
		name = "dhe_dde_pyrrhus.32.a"
		hidden_effect = {
			p:56.region = {
				every_region_province= {
					limit = {
						NOT = { owner = c:EPI }
					}
					add_claim = c:EPI
				}
			}
		}
		custom_tooltip = dhe_dde_pyrrhus.32.at
	}
}